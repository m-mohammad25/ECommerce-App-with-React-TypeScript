import{r as x,v as A,b as k,f as N,d as P,q as C,w as F,j as e}from"./index-Bq_BoyWd.js";import{H as R}from"./style-qmAhOpjk.js";import"./style-C5DDRcX9.js";import{z as o,u as B,t as q,I as d}from"./index-BMT5gYsc.js";import{R as H,C as T}from"./Row-190GaXY8.js";import{F as D,S as I}from"./Spinner-DopUcn5i.js";import{B as U}from"./Button-eU2eWRp9.js";import"./Button-DpFDe-S0.js";const z=()=>{const[r,a]=x.useState("idle"),[s,l]=x.useState(null);return{emailAvailabilityStatus:r,enteredEmail:s,checkEmailAvailability:async n=>{l(n),a("checking");try{(await A.get(`users?email=${n}`)).data.length?a("notAvailable"):a("available")}catch{a("failed")}},resetCheckEmailAvailability:()=>{a("idle"),l(null)}}},L=o.object({firstName:o.string().min(1,{message:"first name is required"}),lastName:o.string().min(1,{message:"last name is required"}),email:o.string().min(1,{message:"Email is required"}).email({message:"must be a valid email address"}),password:o.string().min(8,{message:"password must be 8 characters at least"}).regex(/.*[!@#$%^&*()_+{}|[\]\\:";'<>?,./].*/,{message:"Password should contain at least 1 special character"}),confirmPassword:o.string().min(1,{message:"Confirm password is required"})}).refine(r=>r.password===r.confirmPassword,{message:"Passowrds don't match",path:["confirmPassword"]});function O(){const r=k(),a=N(),{error:s,loading:l,accessToken:u}=P(c=>c.auth),{register:t,handleSubmit:n,formState:{errors:i},getFieldState:g,trigger:h}=B({resolver:q(L),mode:"onBlur"}),{emailAvailabilityStatus:f,enteredEmail:m,checkEmailAvailability:p,resetCheckEmailAvailability:b}=z(),E=c=>{const{firstName:v,lastName:w,email:y,password:j}=c;a(F({firstName:v,lastName:w,email:y,password:j})).unwrap().then(()=>{r("/login?message=Your account has been created successfully, please login")})},S=async c=>{await h("email");const{isDirty:v,invalid:w}=g("email"),y=c.target.value;v&&!w&&m!==y&&p(y),v&&!w&&m&&b()};return u&&r("/"),x.useEffect(()=>()=>{a(C())},[]),{error:s,loading:l,emailAvailabilityStatus:f,emailOnBlurHandler:S,onSubmit:E,register:t,handleSubmit:n,formErrors:i}}function K(){var g,h,f,m,p,b;const{error:r,loading:a,emailAvailabilityStatus:s,emailOnBlurHandler:l,onSubmit:u,register:t,handleSubmit:n,formErrors:i}=O();return e.jsxs(e.Fragment,{children:[e.jsx(R,{title:"User Registeration"}),e.jsx(H,{children:e.jsx(T,{md:{span:6,offset:3},children:e.jsxs(D,{className:"mb-4",onSubmit:n(u),children:[e.jsx(d,{label:"First Name",name:"firstName",register:t,error:(g=i.firstName)==null?void 0:g.message}),e.jsx(d,{label:"Last Name",name:"lastName",register:t,error:(h=i.lastName)==null?void 0:h.message}),e.jsx(d,{label:"Email address",name:"email",register:t,onBlur:l,error:(f=i.email)!=null&&f.message?(m=i.email)==null?void 0:m.message:s==="notAvailable"?"This email is already in use.":s==="failed"?"Error from the server.":"",success:s==="available"?"This email is available":"",checkingMsg:s==="checking"?"We're currently checking the availability of this email address. Please wait a moment.":"",disabled:s==="checking"}),e.jsx(d,{label:"Password",name:"password",register:t,error:(p=i.password)==null?void 0:p.message}),e.jsx(d,{label:"Confirm Password",name:"confirmPassword",register:t,error:(b=i.confirmPassword)==null?void 0:b.message}),e.jsx(U,{variant:"info",type:"submit",style:{color:"white"},disabled:s==="checking"?!0:a==="pending",children:a==="pending"?e.jsxs(e.Fragment,{children:[e.jsx(I,{animation:"border",size:"sm"})," Loading..."," "]}):"Submit"}),e.jsx("p",{style:{color:"#DC3545",marginTop:"10px"},children:r})]})})})]})}export{K as default};
